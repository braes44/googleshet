<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bot Google Sheets</title>
    <script>
        const SHEET_ID = "1uP70j2dloWqT6tftexTCnZELBxxRpQ11D0CqJj3LLF8";
        const SHEET_NAME = "Hoja1";
        const API_KEY = "TU_GOOGLE_SHEETS_API_KEY";  // Sustituir con una clave v√°lida

        async function cargarDatos() {
            const url = `https://sheets.googleapis.com/v4/spreadsheets/${SHEET_ID}/values/${SHEET_NAME}?key=${API_KEY}`;
            const response = await fetch(url);
            const data = await response.json();
            
            let tabla = "<table border='1'><tr>";
            data.values[0].forEach(col => { tabla += `<th>${col}</th>`; });
            tabla += "</tr>";

            data.values.slice(1).forEach(row => {
                tabla += "<tr>";
                row.forEach(cell => { tabla += `<td>${cell}</td>`; });
                tabla += "</tr>";
            });

            document.getElementById("datos").innerHTML = tabla + "</table>";
        }

        async function agregarDato() {
            const nuevoDato = document.getElementById("nuevoDato").value;
            if (!nuevoDato) return alert("Ingresa un dato");

            const url = `https://script.google.com/macros/s/TU_DEPLOYMENT_ID/exec`;
            const response = await fetch(url, {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({ dato: nuevoDato })
            });

            if (response.ok) {
                alert("Dato agregado correctamente.");
                cargarDatos();
            } else {
                alert("Error al agregar datos.");
            }
        }
    </script>
</head>
<body onload="cargarDatos()">
    <h1>Interfaz Bot Google Sheets</h1>
    <div>
        <input type="text" id="nuevoDato" placeholder="Escribe un dato">
        <button onclick="agregarDato()">Agregar</button>
    </div>
    <h2>Datos en la hoja:</h2>
    <div id="datos"></div>
</body>
</html>
